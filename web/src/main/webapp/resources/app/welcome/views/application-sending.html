<section id=applicationSection>

    <div class="col-md-12 text-center" ng-hide="errorEdit" ng-show="isShownForm">
        <h1>{{ 'APP_SENDING_TITLE' | translate }}</h1>
    </div>
    <div class="row">
        <div class="col-md-12"></div>
    </div>
    <div class="col-md-10" id="createByPattern" ng-show="!isShownForm && codes[0]">
        <button type="button" class="btn btn-info btn-lg" ng-click="createNew(codes[0])">
            <span class="glyphicon glyphicon-duplicate"></span> {{'CREATE_BY_PATTERN'| translate}}
        </button>
    </div>
    <div class="from-top form-group ">
        <div id="clientFormBox" ng-show="isShownForm"
             class="row col-md-8 centered">
            <form id="clientForm" name="clientForm"
                  class="form-horizontal form-group" ng-submit="sendApplicationData()"
                  novalidate>
                <div class="form-group" show-errors>
                    <label for="lastName" class="col-md-2 control-label">
                        {{'LAST_NAME' | translate}} </label>

                    <div class="col-md-8">
                        <input id="lastName" name="lastName" class="form-control"
                               type="text" ng-model="formData.lastName"

                               popover="{{'ALPHABETIC_INFO' | translate}}"
                               popover-trigger="focus" popover-placement="right"
                               ng-pattern="FIRST_LAST_NAME_REGEX" required> <span
                            class="form-control-feedback glyphicon  form-horizontal glyphicon glyphicon-ok-sign"></span>

                        <p class="help-block" ng-if="clientForm.lastName.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'REQUIRED' | translate}}
                        </p>

                        <p class="help-block" ng-if="clientForm.lastName.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'DOUBLE_NAME_ERROR' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="firstName" class="col-md-2 control-label">
                        {{'FIRST_NAME' | translate}} </label>

                    <div class="col-md-8">
                        <input id="firstName" name="firstName" class="form-control"
                               ng-model="formData.firstName"
                               popover="{{'ALPHABETIC_INFO' | translate}}"
                               popover-trigger="focus" popover-placement="right"
                               ng-pattern="FIRST_LAST_NAME_REGEX" required> <span
                            class="form-control-feedback glyphicon  form-horizontal glyphicon glyphicon-ok-sign"></span>

                        <p class="help-block" ng-if="clientForm.firstName.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'REQUIRED' | translate}}
                        </p>

                        <p class="help-block" ng-if="clientForm.firstName.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'DOUBLE_NAME_ERROR' | translate}}
                        </p>
                    </div>
                </div>

                <div class="form-group" show-errors>
                    <label for="middleName" class="col-md-2 control-label">
                        {{'MIDDLE_NAME' | translate}} </label>

                    <div class="col-md-8">
                        <input id="middleName" name="middleName" type="text"
                               class="form-control" ng-model="formData.middleName"
                               popover="{{'MIDDLE_NAME_INFO' | translate}}"
                               popover-trigger="focus" popover-placement="right"
                               ng-pattern="MIDDLE_NAME_REGEX" required> <span
                            class="form-control-feedback glyphicon  form-horizontal glyphicon glyphicon-ok-sign"></span>

                        <p class="help-block"
                           ng-if="clientForm.middleName.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'REQUIRED' | translate}}
                        </p>

                        <p class="help-block" ng-if="clientForm.middleName.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'DOUBLE_NAME_ERROR' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="email" class="col-md-2 control-label">
                        {{'EMAIL' | translate}} </label>

                    <div class="col-md-8">
                        <input id="email" name="email" type="email" class="form-control"
                               ng-model="formData.email" placeholder="example@gmail.com"
                               ng-pattern="EMAIL_REGEX" required> <span
                            class="form-control-feedback glyphicon  form-horizontal glyphicon glyphicon-ok-sign"></span>

                        <p class="help-block" ng-if="clientForm.email.$error.email">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'EMAIL_ERROR' | translate}}<i>example@gmail.com</i>
                        </p>

                        <p class="help-block" ng-if="clientForm.email.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'EMAIL_ERROR' | translate}}<i>example@gmail.com</i>
                        </p>

                        <p class="help-block" ng-if="clientForm.email.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'REQUIRED' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="phoneNumber" class="col-md-2 control-label">
                        {{'PHONE_NUMBER' | translate}} </label>

                    <div class="col-md-8">
                        <div>
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon-code">+380</span>
                                <input id="phoneNumber" name="phoneNumber" type="tel"
                                       class="form-control col-md-8 " ng-model="formData.phone"
                                       placeholder="XXXXXXXXX" ng-pattern="PHONE_REGEX" required>


                                <div class="input-group-addon btn btn-default btn-circle"><label for="checkboxModel"><i
                                        class="glyphicon glyphicon-plus"/></label> <input type="checkbox"
                                                                                          ng-model="checkboxModel"
                                                                                          id="checkboxModel"></div>

                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <p class="help-block col-md-8 col-md-offset-2"
                           ng-if="clientForm.phoneNumber.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'PHONE_NUMBER_ERROR' | translate}}</p>

                        <p class="help-block col-md-8 col-md-offset-2"
                           ng-if="clientForm.email.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'REQUIRED' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors ng-show="checkboxModel">
                    <label for="phoneNumberSecond" class="col-md-2 control-label">
                        {{'SECOND_PHONE' | translate}} </label>

                    <div class="col-md-8">
                        <div>
                            <div class="input-group" ng-show="checkboxModel">
                                <span class="input-group-addon" id="basic-addon-code">+380</span>
                                <input id="phoneNumberSecond" name="phoneNumberSecond"
                                       class="form-control" ng-model="formData.secondPhone"
                                       placeholder="XXXXXXXXX" ng-pattern="PHONE_REGEX_SECOND"
                                       popover="{{'PHONE_NUMBER_INFO' | translate}}"
                                       popover-trigger="focus" popover-placement="right">
                            </div>
							<span
                                    class="form-control-feedback glyphicon  form-horizontal glyphicon glyphicon-ok-sign"
                                    ng-show="checkboxModel"></span>
                        </div>
                    </div>
                    <div class="form-group">
                        <p class="help-block col-md-8 col-md-offset-2"
                           ng-if="clientForm.phoneNumberSecond.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'PHONE_NUMBER_ERROR' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="region" class="col-md-2 control-label">
                        {{'REGION' | translate}}
                    </label>

                    <div class="col-md-8">
                        <select chosen options="regions" id="region" name="region" type="text"
                                class="form-control " ng-model="selectedRegion"
                                data-placeholder="Оберіть область"
                                ng-options="region as region.designation for region in regions | filter: $viewValue"

                                allow-single-deselect="true"
                                ng-change="receiveDistricts(selectedRegion)" width="'100%'" required>
                            <option>
                            <option>
                        </select>

                        <p class="help-block">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'TYPEAHEAD_ERROR' | translate}}
                        </p>
                    </div>
                </div>

                <div class="form-group" show-errors>
                    <label for="district" class="col-md-2 control-label">
                        {{'DISTRICT' | translate}} </label>

                    <div class="col-md-8">
                        <select chosen id="district" name="district" class="form-control "
                                type="text" ng-model="selectedDistrict"
                                data-placeholder="Оберіть район"

                                ng-options="district as district.designation for district in districts | filter: $viewValue"
                                allow-single-deselect="true"
                                ng-change="receiveLocalitiesAndProviders(selectedDistrict)" width="'100%'"
                                required>
                            <option>
                            <option>
                        </select>

                        <p class="help-block">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'TYPEAHEAD_ERROR' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="locality" class="col-md-2 control-label">
                        {{'LOCALITY' | translate}} </label>

                    <div class="col-md-8">
                        <select chosen id="locality" name="locality" class="form-control"
                                data-placeholder="Оберіть населений пункт"
                                ng-model="selectedLocality" allow-single-deselect="true"
                                ng-options="locality as locality.designation for locality in localities | unique:'designation'"
                                ng-change="receiveStreets(selectedLocality,selectedDistrict)" width="'100%'" required>
                            <option>
                            <option>
                        </select>


                        <p class="help-block">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'TYPEAHEAD_ERROR' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="Index" class="col-md-2 control-label"> {{'INDEX' | translate}}</label>

                    <div class="col-md-8">
                        <select chosen id="index" name="index" class="form-control"
                                ng-model="selectedIndex" allow-single-deselect="true"
                                disable-search="true"

                                data-placeholder="Поштовий індекс"
                                ng-options="index as index.mailIndex for index in indexes | filter: $viewValue"
                                ng-change="receiveStreetsTypes()"
                                width="'100%'">
                            <option>
                            <option>
                        </select>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="street" class="col-md-2 control-label">
                        {{'STREET' | translate}} </label>

                    <div class="col-md-8">
                        <div class="pull-left col-lg-3" id="typeStreet">
                            <select chosen data-placeholder="Тип вулиці"
                                    width="'90%'" class="form-control"
                                    ng-model="selectedStreetType"
                                    disable-search="true"
                                    ng-options="streetsType as streetsType.designation for streetsType in streetsTypes | filter: $viewValue"
                                    ></select>
                        </div>
                        <div class="col-md-9" id="streetBox">
                            <input name="street" class="form-control" type="text" id="street"
                                   ng-model="selectedStreet"
                                   typeahead="street as street.designation for street in streets | filter: $viewValue | limitTo: 4"

                                   typeahead-on-select="receiveBuildings(selectedStreet)"
                                   required><!-- ng-pattern="STREET_REGEX"-->
                        </div>
                        <span class="form-control-feedback glyphicon form-horizontal glyphicon glyphicon-ok-sign"></span>
                    </div>
                    <p class="help-block col-md-offset-2">
                        <span class="glyphicon glyphicon-exclamation-sign"></span>
                        {{'DOUBLE_NAME_ERROR' | translate}}
                    </p>
                </div>
                <div class="form-group" show-errors>
                    <label for="building" class="col-md-2 control-label">
                        {{'BUILDING' | translate}} </label>

                    <div class="col-md-8">
                        <input id="building" name="building" class="form-control"
                               ng-model=" selectedBuilding"
                               typehead="building as building.designation for building in buildings | filter: $viewValue | limitTo: 4"
                               ng-pattern="BUILDING_REGEX" required><span
                            class="form-control-feedback glyphicon form-horizontal glyphicon glyphicon-ok-sign"></span>

                        <a ng-if="!selectedProvider && selectedDistrict && selectedLocality && selectedIndex && selectedStreetType && selectedStreet && selectedBuilding"
                           style="color: #b27e77"
                           ng-click="feedbackModalNoProvider()"> <i class="fa fa-info-circle">
                            <ins>Не існує постачальника послуг для даного району. Повідомте нам про це.</ins>
                        </i>
                        </a>

                        <p class="help-block" ng-if="clientForm.building.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'REQUIRED' | translate}}
                        </p>

                        <p class="help-block"
                           ng-if="clientForm.building.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'BUILDING_ERROR' | translate}}
                        </p>
                    </div>
                </div>
                <div class="form-group" show-errors>
                    <label for="flat" class="col-md-2 control-label">{{'FLAT' | translate}}</label>

                    <div class="col-md-8">
                        <input id="flat" name="flat" class="form-control"
                               ng-model="formData.flat" popover="{{'FLAT_INFO' | translate}}"
                               popover-trigger="focus" popover-placement="right"
                               ng-pattern="FLAT_REGEX" required>
                        <span class="form-control-feedback glyphicon form-horizontal glyphicon glyphicon-ok-sign"></span>

                        <p class="help-block" ng-if="clientForm.flat.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'REQUIRED' | translate}}
                        </p>

                        <p class="help-block"
                           ng-if="clientForm.flat.$error.pattern">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'FLAT_ERROR' | translate}}
                        </p>
                    </div>
                </div>

                <div class="form-group" show-errors>
                    <label for="device" class="col-md-2 control-label">
                        {{'COUNTER_CATEGORY' | translate}} </label>

                    <div class="col-md-8 " id="counterNumber">
                        <div class="pull-left col-lg-3">
                            <select chosen width="'100%'" id="firstDeviceCount" name="firstDeviceCount"
                                    data-placeholder="Кількість"
                                    disable-search="true"
                                    type="text"
                                    ng-model="firstDeviceCount" class="form-control" required>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </div>
                        <div class="col-md-9 pull-right input-group " id="deviceBox">
                            <select chosen type="text" width="'100%'" name="firstSelectedDevice"
                                    id="firstSelectedDevice"
                                    ng-model="firstSelectedDevice"
                                    data-placeholder="Категорія лічильника"
                                    ng-required="test"
                                    ng-options="device as device.designation for device in devices | filter: $viewValue"
                                    required>
                            </select>

                            <div class="input-group-addon btn btn-default btn-circle " for="isSecondDeviceCheck">
                                <label for="isSecondDeviceCheck"><i
                                        class="glyphicon glyphicon-plus input-block-level"/></label>
                                <input type="checkbox"
                                       ng-model="isSecondDevice"
                                       id="isSecondDeviceCheck"/>
                            </div>
                        </div>
                        <p class="help-block" ng-if="clientForm.firstDeviceCount.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'TYPEAHEAD_ERROR' | translate}}
                        </p>

                        <p class="help-block"
                           ng-if="clientForm.firstSelectedDevice.$invalid">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'DEVICE_TYPE_REQUIRED' | translate}}
                        </p>
                    </div>
                </div>

                <div class="form-group" show-errors ng-show="isSecondDevice">
                    <label for="device2" class="col-md-2 control-label">
                        {{'COUNTER_CATEGORY' | translate}} </label>

                    <div class="col-md-8 ">
                        <div class="pull-left col-lg-3" id="counterNumber">
                            <select chosen width="'100%'"
                                    ng-required="isSecondDevice"
                                    disable-search="true"
                                    data-placeholder="Кількість"
                                    ng-model-options="{allowInvalid: true}"
                                    id="secondDeviceCount" name="secondDeviceCount"
                                    type="text"
                                    ng-model="secondDeviceCount" class="form-control">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </div>
                        <div class="col-md-9 pull-right input-group" id="deviceBox">
                            <select chosen
                                    name="secondSelectedDevice"
                                    id="secondSelectedDevice"
                                    type="text"
                                    ng-model-options="{allowInvalid: true}"
                                    width="'100%'"
                                    ng-model="secondSelectedDevice"
                                    data-placeholder="Категорія лічильника"
                                    ng-options="device as device.designation for device in devices | filter: $viewValue">
                            </select>

                            <div class="input-group-addon  btn btn-default btn-circle"><label
                                    for="isThirdDeviceCheck"><i
                                    class="glyphicon glyphicon-plus"/></label>
                                <input type="checkbox"
                                       ng-model="isThirdDevice"
                                       id="isThirdDeviceCheck"/>
                            </div>
                        </div>
                        <p class="help-block" ng-if="clientForm.secondDeviceCount.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'TYPEAHEAD_ERROR' | translate}}
                        </p>

                        <p class="help-block"
                           ng-if="clientForm.secondSelectedDevice.$invalid">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'DEVICE_TYPE_REQUIRED' | translate}}
                        </p>
                    </div>
                </div>

                <div class="form-group" show-errors ng-show="isThirdDevice">
                    <label for="device3" class="col-md-2 control-label">
                        {{'COUNTER_CATEGORY' | translate}} </label>

                    <div class="col-md-8 ">
                        <div class="pull-left col-lg-3" id="counterNumber">
                            <select chosen width="'100%'"
                                    ng-required="isThirdDevice"
                                    data-placeholder="Кількість"
                                    disable-search="true"
                                    ng-model-options="{allowInvalid: true}"
                                    id="thirdDeviceCount" name="thirdDeviceCount"
                                    name="typeStreet" type="text"
                                    ng-model="thirdDeviceCount" class="form-control">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </div>
                        <div class="col-md-9 pull-right input-group" id="deviceBox">
                            <select chosen
                                    name="thirdSelectedDevice"
                                    id="thirdSelectedDevice"
                                    type="text" width="'100%'"
                                    ng-model="thirdSelectedDevice"
                                    allow-single-deselect="true"
                                    ng-model-options="{allowInvalid: true}"
                                    data-placeholder="Категорія лічильника"
                                    ng-options="device as device.designation for device in devices | filter: $viewValue">
                            </select>
                        </div>
                        <p class="help-block" ng-if="clientForm.thirdDeviceCount.$error.required">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'TYPEAHEAD_ERROR' | translate}}
                        </p>

                        <p class="help-block"
                           ng-if="clientForm.thirdSelectedDevice.$invalid">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'DEVICE_TYPE_REQUIRED' | translate}}
                        </p>
                    </div>
                </div>

                <div class="form-group">
                    <label for="comment" class="col-md-2 control-label">
                        {{'APPLICATION_COMMENT' | translate}}
                        <a popover="{{'APPLICATION_COMMENT_EXAMPLE' | translate}}"
                           popover-trigger="mouseenter">
                            <i class="fa fa-question-circle"></i>
                        </a>
                    </label>

                    <div class="col-md-8">
                        <textarea id="comment" name="comment" class="form-control" rows="3"
                                  ng-model="formData.comment" maxlength="254"></textarea>
                        <!--<p class="help-block"
                           ng-if="clientForm.comment.$error.maxlength">
                            <span class="glyphicon glyphicon-exclamation-sign"></span>
                            {{'DEVICE_TYPE_REQUIRED' | translate}}
                        </p>-->
                    </div>
                </div>

                <div class="form-group ">
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-success  pull-right text-uppercase">
                            {{'SEND_BTN' | translate}}
                        </button>
                    </div>
                    <div class="col-md-2">
                        <button type="reset" class="btn btn-warning text-uppercase" ng-click="resetApplicationForm()">
                            {{'CLEAR_FORM'|translate}}
                        </button>
                    </div>
                    <div class="col-md-offset-4 col-md-2">
                        <button class="btn btn-danger pull-right text-uppercase" ng-click="closeAlert()">
                            {{'CLOSE'|translate}}
                        </button>
                    </div>
                </div>

            </form>
        </div>

        <div class="progress col-md-8 col-md-offset-2" ng-show="appProgress"
             style="padding-left:0px;padding-right:0px;height: 30px">

            <div class="progress-bar progress-bar-striped active"
                 role="progressbar" aria-valuenow="100" aria-valuemin="0"
                 aria-valuemax="100" style="width:100%; height: 30px">{{'DATA_PROCESSING' | translate}}...
            </div>
        </div>
        <div ng-hide="isShownForm && !appProgress">
            <div ng-repeat="code in codes"
                 ng-show="!appProgress"
                 class="row col-md-10 alert alert-success alert-dismissible centered" role="alert"
                 style="text-align: center">
                <!-- <button ng-click="closeAlert()" type="button"
                         class="close btn-close-alert" aria-label="Close">
                     <span aria-hidden="true">&times;</span>
                 </button>-->
                <br>

                <div class="text-center" ng-show="!appProgress">
                    {{'APP_SENT' | translate}}<a href="/#/application-status/{{code}}">
                    <b>{{code}} </b> </a>><br>
                    {{'APP_SENT_INFO' | translate}}

                </div>
                <br>
            </div>
        </div>
    </div>

</section>
